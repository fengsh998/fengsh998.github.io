---
layout: post
title: "AEM开发系列-创建自己的站点(二)"
categories: AEM开发系列
tags: AEM
author: fengsh998
typora-root-url: ..
---

# AEM 创建自己的站点

环境要求: MAVEN 3.3.6及以上版本。

## 创建工程

使用aem-project-archetype脚手架进行创建项目
[脚手架官网](https://github.com/adobe/aem-project-archetype)

{% highlight shell %}
mvn -B org.apache.maven.plugins:maven-archetype-plugin:3.3.1:generate \
 -D archetypeGroupId=com.adobe.aem \
 -D archetypeArtifactId=aem-project-archetype \
 -D archetypeVersion=54\
 -D appTitle="FshSite" \
 -D appId="fshsite" \
 -D groupId="com.fshsite"
{% endhighlight %}

> archetypeVersion 指定脚手架版本号
appTitle 项目名称
appId 项目id
groupId 项目的groupid
{: .prompt-info }

生成的项目中的README.md中有非常详细的mvn使用的命令：

> 
#使用maven3，在根目录下运行
mvn clean install

#要将所有构建的模块部署到本地的AEM(author服务)，则运行下面命令
mvn clean install -PautoInstallSinglePackage

#部署到AEM(publish服务)
mvn clean install -PautoInstallSinglePackagePublish

#或者使用端口指定
mvn clean install -PautoInstallSinglePackage -Daem.port=4503

#部署包(bundle)到author服务，则运行
mvn clean install -PautoInstallBundle

#部署单个内容包则到子目录下运行（如：ui.apps下）
mvn clean install -PautoInstallPackage

{: .prompt-tip }

通常只需要使用`mvn clean install -PautoInstallSinglePackage` 即可将项目发布到本地的author服务上。

## 常用的地址连接

```
包管理器: http://localhost:4502/crx/packmgr/index.jsp
CRXDE: http://localhost:4502/crx/de/index.jsp
AEM Web控制台: http://localhost:4502/system/console
AEM系统信息: http://localhost:4502/system/console/status-productinfo
查询性能控制台: http://localhost:4502/libs/granite/operations/content/diagnosistools/queryPerformance.html
查询调试器: http://localhost:4502/libs/cq/search/content/querydebug.html
```

至此即可进行本地的AEM进行开发了。

## 本地部署Dispatcher

> 需要安装Docker环境
{: .prompt-tip }

步聚：
1、将下载的AEM SDK解压出来后，执行脚本，把dispatcher工具提取出来。

{% highlight shell %}
chmod a+x aem-sdk-dispatcher-tools-x.x.x-unix.sh
$ ./aem-sdk-dispatcher-tools-x.x.x-unix.sh
{% endhighlight %}

执行提取脚本后会自动创建一个dispather-sdk-version的文件夹。

![img](/assets/articles/aem/自己站点/dispather.jpg)

验证工具是否可用

{% highlight shell %}
cd dispatcher-sdk-2.0.252
./bin/validate.sh ./src
{% endhighlight %}

启动dispather

{% highlight shell %}
cd dispatcher-sdk-2.0.252
./bin/docker_run_hot_reload.sh ./src host.docker.internal:4503 8099
{% endhighlight %}

> 本地运行Dispatcher 工具，得优先把publish服务先启动
{: .prompt-warning }

然后就可以浏览器中进行访问了，如http://localhost:8099/content/your-site-name/us/es.html




参考：
[原型项目](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-core-components/using/developing/archetype/overview)

[aem-guides-wknd](https://github.com/adobe/aem-guides-wknd)

[WKND教程](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-learn/getting-started-wknd-tutorial-develop/overview)
