---
layout: post
title: "STM32(自学)-点亮OLED屏【ssd1306驱动芯片128x64】(六)"
categories: STM32
tags: STM32
author: fengsh998
typora-root-url: ..
---


网上搞了一块OLED屏回来，商家给到的资料都是标准库的OLED封装，在CubeIDE上，现在都大多基于HAL库了，没有经验的话，一时半会还改不上来。折腾了半天也点不亮，一度怀疑屏有问题。正好手上有一块Arduino Uno R3 的开发版，这个有较好的封装库，先用这个来验一下屏是否正常，后结搞懂STM32的相关编程后再来点亮。


硬件接线：

|OLED(7Pin4线SPI)|Arduino 引脚| STM32F103C8T6 开发板|
|---|-----|-----|
|GND|GND|GND|
|VCC|3V3|3V3|
|SCK/D0 时钟|D13|PA5|
|SDA/MOSI/D1/DIN 数据|D11|PA7|
|RST 复位|D8|PB0|
|DC 数据/命令切换|D9|PB1|
|CS/NSS 片选|D10|PA4|

OLED 不需要 MISO（因为它只接收，不发送），所以用 D/C 线来切换「命令」还是「数据」

通信协议
|总线|信号线数量|线名|
|----|----|---|
|SPI（四线）|4|SCK, MOSI, CS, DC|
|$$ I^2C $$|2|SCL, SDA|

## Arduino Uno R3

实物接线图：

![img](/assets/articles/ic/stm32/oled/oled1.jpg)
![img](/assets/articles/ic/stm32/oled/oled2.jpg)

使用Arduino 时，需要安装U8g2库,打开库管理-> U8g2 安装

![img](/assets/articles/ic/stm32/oled/ardunio1.jpg)

程序：
```c
#include <U8g2lib.h>

// 正确：构造函数名是大写 U8G2
U8G2_SSD1306_128X64_NONAME_F_4W_HW_SPI U8G2(
    U8G2_R0,      // 不旋转
    /* cs=*/ 10,   // CS  → D10
    /* dc=*/ 9,    // DC  → D9
    /* reset=*/ 8  // RST → D8
);

void setup(void) {
  U8G2.begin();                    // 初始化
  
}

void loop(void) {
  U8G2.clearBuffer();              // 清缓冲区
  U8G2.setFont(u8g2_font_ncenB14_tr); // 设置字体
  U8G2.drawStr(0, 20, "HELLO!");
  U8G2.drawStr(0, 40, "SSD1306 OK");
  U8G2.drawStr(0, 60, "7Pin SPI");
  U8G2.sendBuffer();               // 发送到屏幕
  // 保持显示
}
```
直接烧录完，Reset一把就可以显示了。接下来得捣整一下STM32的了。




